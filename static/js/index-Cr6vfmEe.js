import{A as ce,u as fe,d as ge,r as m,B as _e,J as be,aJ as ve,e as r,G as I,c as F,o as g,H as d,f as t,I as G,l as a,i as n,m as K,D as L,n as y,j as h,h as Y,t as Q,K as ye,L as he}from"./index-BsWVLLtj.js";import{a as we,b as Ce,d as Ne,p as ke,s as Se}from"./gen-C9KH5gns.js";import xe from"./importTable-CSOnQ9uo.js";const Ve={class:"app-container"},$e=ce({name:"Gen"}),Ue=Object.assign($e,{setup(De){const U=fe(),{proxy:s}=ge(),q=m([]),$=m(!0),S=m(!0),D=m([]),z=m(!0),P=m(!0),T=m(0),R=m([]),w=m([]),B=m(""),N=m({prop:"createTime",order:"descending"}),J=_e({queryParams:{pageNum:1,pageSize:10,tableName:void 0,tableComment:void 0,orderByColumn:N.value.prop,isAsc:N.value.order},preview:{open:!1,title:"代码预览",data:{},activeName:"domain.java"}}),{queryParams:i,preview:c}=be(J);ve(()=>{const l=U.query.t;l!=null&&l!=B.value&&(B.value=l,i.value.pageNum=Number(U.query.pageNum),w.value=[],s.resetForm("queryForm"),v())});function v(){$.value=!0,we(s.addDateRange(i.value,w.value)).then(l=>{q.value=l.rows,T.value=l.total,$.value=!1})}function x(){i.value.pageNum=1,v()}function A(l){const e=l.tableName||R.value;if(e==""){s.$modal.msgError("请选择要生成的数据");return}if(l.genType==="1")Ce(l.tableName).then(_=>{s.$modal.msgSuccess("成功生成到自定义路径："+l.genPath)});else{const _=Array.isArray(e)?"ruoyi.zip":e+".zip";s.$download.zip("/code/gen/batchGenCode?tables="+e,_)}}function M(l){const e=l.tableName;s.$modal.confirm('确认要强制同步"'+e+'"表结构吗？').then(function(){return Se(e)}).then(()=>{s.$modal.msgSuccess("同步成功")}).catch(()=>{})}function H(){s.$refs.importRef.show()}function W(){w.value=[],s.resetForm("queryRef"),i.value.pageNum=1,s.$refs.genRef.sort(N.value.prop,N.value.order)}function X(l){ke(l.tableId).then(e=>{c.value.data=e.data,c.value.open=!0,c.value.activeName="domain.java"})}function Z(){s.$modal.msgSuccess("复制成功")}function ee(l){D.value=l.map(e=>e.tableId),R.value=l.map(e=>e.tableName),z.value=l.length!=1,P.value=!l.length}function te(l,e,_){i.value.orderByColumn=l.prop,i.value.isAsc=l.order,v()}function O(l){const e=l.tableId||D.value[0],_=l.tableName||R.value[0],C={pageNum:i.value.pageNum};s.$tab.openPage("修改["+_+"]生成配置","/tool/gen-edit/index/"+e,C)}function E(l){const e=l.tableId||D.value;s.$modal.confirm('是否确认删除表编号为"'+e+'"的数据项？').then(function(){return Ne(e)}).then(()=>{v(),s.$modal.msgSuccess("删除成功")}).catch(()=>{})}return v(),(l,e)=>{const _=r("el-input"),C=r("el-form-item"),le=r("el-date-picker"),u=r("el-button"),ae=r("el-form"),V=r("el-col"),ne=r("right-toolbar"),oe=r("el-row"),b=r("el-table-column"),k=r("el-tooltip"),ie=r("el-table"),re=r("pagination"),se=r("el-link"),de=r("el-tab-pane"),ue=r("el-tabs"),pe=r("el-dialog"),f=I("hasPermi"),me=I("loading"),j=I("copyText");return g(),F("div",Ve,[d(t(ae,{model:a(i),ref:"queryRef",inline:!0},{default:n(()=>[t(C,{label:"表名称",prop:"tableName"},{default:n(()=>[t(_,{modelValue:a(i).tableName,"onUpdate:modelValue":e[0]||(e[0]=o=>a(i).tableName=o),placeholder:"请输入表名称",clearable:"",style:{width:"200px"},onKeyup:K(x,["enter"])},null,8,["modelValue"])]),_:1}),t(C,{label:"表描述",prop:"tableComment"},{default:n(()=>[t(_,{modelValue:a(i).tableComment,"onUpdate:modelValue":e[1]||(e[1]=o=>a(i).tableComment=o),placeholder:"请输入表描述",clearable:"",style:{width:"200px"},onKeyup:K(x,["enter"])},null,8,["modelValue"])]),_:1}),t(C,{label:"创建时间",style:{width:"308px"}},{default:n(()=>[t(le,{modelValue:a(w),"onUpdate:modelValue":e[2]||(e[2]=o=>L(w)?w.value=o:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(C,null,{default:n(()=>[t(u,{type:"primary",icon:"Search",onClick:x},{default:n(()=>e[8]||(e[8]=[y("搜索")])),_:1,__:[8]}),t(u,{icon:"Refresh",onClick:W},{default:n(()=>e[9]||(e[9]=[y("重置")])),_:1,__:[9]})]),_:1})]),_:1},8,["model"]),[[G,a(S)]]),t(oe,{gutter:10,class:"mb8"},{default:n(()=>[t(V,{span:1.5},{default:n(()=>[d((g(),h(u,{type:"primary",plain:"",icon:"Download",onClick:A},{default:n(()=>e[10]||(e[10]=[y("生成")])),_:1,__:[10]})),[[f,["tool:gen:code"]]])]),_:1}),t(V,{span:1.5},{default:n(()=>[d((g(),h(u,{type:"info",plain:"",icon:"Upload",onClick:H},{default:n(()=>e[11]||(e[11]=[y("导入")])),_:1,__:[11]})),[[f,["tool:gen:import"]]])]),_:1}),t(V,{span:1.5},{default:n(()=>[d((g(),h(u,{type:"success",plain:"",icon:"Edit",disabled:a(z),onClick:O},{default:n(()=>e[12]||(e[12]=[y("修改")])),_:1,__:[12]},8,["disabled"])),[[f,["tool:gen:edit"]]])]),_:1}),t(V,{span:1.5},{default:n(()=>[d((g(),h(u,{type:"danger",plain:"",icon:"Delete",disabled:a(P),onClick:E},{default:n(()=>e[13]||(e[13]=[y("删除")])),_:1,__:[13]},8,["disabled"])),[[f,["tool:gen:remove"]]])]),_:1}),t(ne,{showSearch:a(S),"onUpdate:showSearch":e[3]||(e[3]=o=>L(S)?S.value=o:null),onQueryTable:v},null,8,["showSearch"])]),_:1}),d((g(),h(ie,{ref:"genRef",data:a(q),onSelectionChange:ee,"default-sort":a(N),onSortChange:te},{default:n(()=>[t(b,{type:"selection",align:"center",width:"55"}),t(b,{label:"序号",type:"index",width:"50",align:"center"},{default:n(o=>[Y("span",null,Q((a(i).pageNum-1)*a(i).pageSize+o.$index+1),1)]),_:1}),t(b,{label:"表名称",align:"center",prop:"tableName","show-overflow-tooltip":!0}),t(b,{label:"表描述",align:"center",prop:"tableComment","show-overflow-tooltip":!0}),t(b,{label:"实体",align:"center",prop:"className","show-overflow-tooltip":!0}),t(b,{label:"创建时间",align:"center",prop:"createTime",width:"160",sortable:"custom","sort-orders":["descending","ascending"]}),t(b,{label:"更新时间",align:"center",prop:"updateTime",width:"160",sortable:"custom","sort-orders":["descending","ascending"]}),t(b,{label:"操作",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:n(o=>[t(k,{content:"预览",placement:"top"},{default:n(()=>[d(t(u,{link:"",type:"primary",icon:"View",onClick:p=>X(o.row)},null,8,["onClick"]),[[f,["tool:gen:preview"]]])]),_:2},1024),t(k,{content:"编辑",placement:"top"},{default:n(()=>[d(t(u,{link:"",type:"primary",icon:"Edit",onClick:p=>O(o.row)},null,8,["onClick"]),[[f,["tool:gen:edit"]]])]),_:2},1024),t(k,{content:"删除",placement:"top"},{default:n(()=>[d(t(u,{link:"",type:"primary",icon:"Delete",onClick:p=>E(o.row)},null,8,["onClick"]),[[f,["tool:gen:remove"]]])]),_:2},1024),t(k,{content:"同步",placement:"top"},{default:n(()=>[d(t(u,{link:"",type:"primary",icon:"Refresh",onClick:p=>M(o.row)},null,8,["onClick"]),[[f,["tool:gen:edit"]]])]),_:2},1024),t(k,{content:"生成代码",placement:"top"},{default:n(()=>[d(t(u,{link:"",type:"primary",icon:"Download",onClick:p=>A(o.row)},null,8,["onClick"]),[[f,["tool:gen:code"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-sort"])),[[me,a($)]]),d(t(re,{total:a(T),page:a(i).pageNum,"onUpdate:page":e[4]||(e[4]=o=>a(i).pageNum=o),limit:a(i).pageSize,"onUpdate:limit":e[5]||(e[5]=o=>a(i).pageSize=o),onPagination:v},null,8,["total","page","limit"]),[[G,a(T)>0]]),t(pe,{title:a(c).title,modelValue:a(c).open,"onUpdate:modelValue":e[7]||(e[7]=o=>a(c).open=o),width:"80%",top:"5vh","append-to-body":"",class:"scrollbar"},{default:n(()=>[t(ue,{modelValue:a(c).activeName,"onUpdate:modelValue":e[6]||(e[6]=o=>a(c).activeName=o)},{default:n(()=>[(g(!0),F(ye,null,he(a(c).data,(o,p)=>(g(),h(de,{label:p.substring(p.lastIndexOf("/")+1,p.indexOf(".vm")),name:p.substring(p.lastIndexOf("/")+1,p.indexOf(".vm")),key:o},{default:n(()=>[d((g(),h(se,{underline:!1,icon:"DocumentCopy",style:{float:"right"}},{default:n(()=>e[14]||(e[14]=[y(" 复制")])),_:2,__:[14]},1024)),[[j,o],[j,Z,"callback"]]),Y("pre",null,Q(o),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"]),t(a(xe),{ref:"importRef",onOk:x},null,512)])}}});export{Ue as default};
